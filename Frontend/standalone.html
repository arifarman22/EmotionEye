<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EmotionEye - AI Emotional Analysis</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="app-container">
    <div class="sidebar">
      <div class="sidebar-header">
        <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png" alt="EmotionEye Logo" class="app-logo" />
        <h1>EmotionEye</h1>
        <p>AI-Powered Emotional Analysis</p>
      </div>
      
      <div class="stats-panel">
        <h3>Emotion Statistics</h3>
        <div class="stat-item">
          <span class="stat-label">Sessions Analyzed</span>
          <span class="stat-value" id="sessions-count">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Current Emotion</span>
          <span class="stat-value" id="current-emotion">-</span>
        </div>
      </div>
      
      <button id="show-trend" class="trend-button">
        <span class="button-icon">üìä</span>
        Sentiment Trends
      </button>
      
      <div class="app-info">
        <p>EmotionEye analyzes your emotions and provides relevant Quranic guidance.</p>
      </div>
    </div>

    <div class="main-content">
      <div class="chat-header">
        <h2>Emotional Analysis Chat</h2>
        <p>Share your feelings and receive personalized guidance</p>
      </div>

      <div class="chat-box" id="chat-box">
        <div class="welcome-message">
          <h3>Welcome to EmotionEye üëÅÔ∏è</h3>
          <p>I'm here to understand your emotions and provide meaningful Quranic guidance. Share what you're feeling today.</p>
        </div>
      </div>

      <form id="chat-form" class="chat-form">
        <input
          type="text"
          id="user-input"
          placeholder="Express your feelings..."
          autocomplete="off"
          required
        />
        <button type="submit">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </form>
    </div>
  </div>

  <div class="chart-modal" id="chart-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Emotion Trend Analysis</h3>
        <button class="close-modal" id="close-modal">√ó</button>
      </div>
      <canvas id="sentimentChart"></canvas>
    </div>
  </div>

  <script>
    // Standalone EmotionEye - No backend needed
    let sessionCount = 0;
    let currentEmotion = '-';
    let emotionTrend = {};

    // Emotion detection
    function detectEmotion(text) {
      text = text.toLowerCase();
      
      const emotions = {
        'joy': ['happy', 'excited', 'great', 'wonderful', 'amazing', 'fantastic', 'good', 'excellent', 'delighted'],
        'sadness': ['sad', 'depressed', 'unhappy', 'down', 'upset', 'bad', 'terrible', 'awful', 'miserable'],
        'anger': ['angry', 'mad', 'furious', 'annoyed', 'frustrated', 'hate', 'irritated'],
        'fear': ['scared', 'afraid', 'worried', 'anxious', 'nervous', 'frightened', 'terrified'],
        'love': ['love', 'adore', 'cherish', 'affection', 'romantic', 'caring'],
        'surprise': ['surprised', 'shocked', 'amazed', 'unexpected', 'wow', 'incredible']
      };
      
      // Check for negative phrases
      if (/not.*good|not.*well|not.*happy|feeling.*bad|feel.*bad/.test(text)) {
        return { emotion: 'sadness', confidence: 0.8 };
      }
      
      // Find matching emotions
      for (const [emotion, keywords] of Object.entries(emotions)) {
        for (const keyword of keywords) {
          if (text.includes(keyword)) {
            return { emotion, confidence: 0.75 };
          }
        }
      }
      
      return { emotion: 'neutral', confidence: 0.6 };
    }

    // Quranic verses
    const quranicVerses = {
      "joy": {
        "verse": "ŸÅŸéÿ•ŸêŸÜŸéŸë ŸÖŸéÿπŸé Ÿ±ŸÑŸíÿπŸèÿ≥Ÿíÿ±Ÿê ŸäŸèÿ≥Ÿíÿ±Ÿã€≠ÿß",
        "translation": "Indeed, with hardship [will be] ease. (Surah Ash-Sharh 94:6)"
      },
      "sadness": {
        "verse": "ŸàŸéŸÑŸéÿß ÿ™ŸéŸáŸêŸÜŸèŸàÿß ŸàŸéŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≤ŸéŸÜŸèŸàÿß ŸàŸéÿ£ŸéŸÜÿ™ŸèŸÖŸè Ÿ±ŸÑŸíÿ£ŸéÿπŸíŸÑŸéŸàŸíŸÜŸé ÿ•ŸêŸÜ ŸÉŸèŸÜÿ™ŸèŸÖ ŸÖŸèŸëÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé",
        "translation": "So do not weaken and do not grieve, and you will be superior if you are [true] believers. (Surah Al-Imran 3:139)"
      },
      "anger": {
        "verse": "ŸàŸéŸ±ŸÑŸíŸÉŸéŸÄŸ∞ÿ∏ŸêŸÖŸêŸäŸÜŸé Ÿ±ŸÑŸíÿ∫ŸéŸäŸíÿ∏Ÿé ŸàŸéŸ±ŸÑŸíÿπŸéÿßŸÅŸêŸäŸÜŸé ÿπŸéŸÜŸê Ÿ±ŸÑŸÜŸéŸëÿßÿ≥Ÿê",
        "translation": "Those who restrain anger and who pardon the people ‚Äì and Allah loves the doers of good. (Surah Al-Imran 3:134)"
      },
      "fear": {
        "verse": "ÿ•ŸêŸÜŸéŸë Ÿ±ŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿπŸé Ÿ±ŸÑÿµŸéŸëŸÄŸ∞ÿ®Ÿêÿ±ŸêŸäŸÜŸé",
        "translation": "Indeed, Allah is with the patient. (Surah Al-Baqarah 2:153)"
      },
      "love": {
        "verse": "ÿ•ŸêŸÜŸéŸë Ÿ±ŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß€ü ŸàŸéÿπŸéŸÖŸêŸÑŸèŸàÿß€ü Ÿ±ŸÑÿµŸéŸëŸÄŸ∞ŸÑŸêÿ≠ŸéŸÄŸ∞ÿ™Ÿê ÿ≥ŸéŸäŸéÿ¨ŸíÿπŸéŸÑŸè ŸÑŸéŸáŸèŸÖŸè Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸÄŸ∞ŸÜŸè ŸàŸèÿØŸãŸë€≠ÿß",
        "translation": "Indeed, those who have believed and done righteous deeds ‚Äì the Most Merciful will appoint for them affection. (Surah Maryam 19:96)"
      },
      "surprise": {
        "verse": "ŸàŸéŸÖŸéÿß ÿ™ŸéÿØŸíÿ±ŸêŸâ ŸÜŸéŸÅŸíÿ≥Ÿå€≠ ŸÖŸéŸëÿßÿ∞Ÿéÿß ÿ™ŸéŸÉŸíÿ≥Ÿêÿ®Ÿè ÿ∫ŸéÿØŸã€≠ÿß",
        "translation": "And no soul knows what it will earn tomorrow. (Surah Luqman 31:34)"
      },
      "neutral": {
        "verse": "Ÿ±ŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿ¢ ÿ•ŸêŸÑŸéŸÄŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé €ö ŸÑŸéŸáŸè Ÿ±ŸÑŸíÿ£Ÿéÿ≥ŸíŸÖŸéÿ¢ÿ°Ÿè Ÿ±ŸÑŸíÿ≠Ÿèÿ≥ŸíŸÜŸéŸâŸ∞",
        "translation": "Allah ‚Äì there is no deity except Him. To Him belong the best names. (Surah Ta-Ha 20:8)"
      }
    };

    // Bot replies
    const replies = {
      "joy": "I sense happiness in your words! May your joy continue to flourish. üòä",
      "sadness": "I'm sorry you're feeling this way. Remember that difficult times pass. üíô",
      "anger": "I understand your frustration. Taking a moment to breathe can help. üò§",
      "fear": "It's okay to feel afraid sometimes. Courage means moving forward despite fear. ü§ù",
      "love": "That's so heartwarming to hear! Love is one of life's greatest blessings. ‚ù§Ô∏è",
      "surprise": "Wow, that sounds unexpected! Life's surprises often bring growth. üò≤",
      "neutral": "Thanks for sharing. I'm here to listen whenever you're ready to explore further. üôÇ"
    };

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById("chat-form").addEventListener("submit", handleChatSubmit);
      document.getElementById("show-trend").addEventListener("click", showSentimentTrend);
      document.getElementById("close-modal").addEventListener("click", closeModal);
      
      document.getElementById("chart-modal").addEventListener("click", function(e) {
        if (e.target === this) closeModal();
      });
      
      updateStatsPanel();
    });

    function handleChatSubmit(e) {
      e.preventDefault();
      
      const input = document.getElementById("user-input");
      const message = input.value.trim();
      if (message === "") return;

      addMessage(message, "user");
      input.value = "";

      // Show typing indicator
      const typingMsg = addMessage("‚è≥ Analyzing your emotions...", "bot");

      // Simulate processing delay
      setTimeout(() => {
        typingMsg.remove();
        
        const result = detectEmotion(message);
        const emotion = result.emotion;
        const confidence = result.confidence;
        
        // Update stats
        sessionCount++;
        currentEmotion = capitalize(emotion);
        emotionTrend[emotion] = (emotionTrend[emotion] || 0) + 1;
        updateStatsPanel();

        // Show results
        addMessage(`ü§ñ ${replies[emotion]}`, "bot");
        addMessage(`üìä Emotion Detected: ${capitalize(emotion)} (${(confidence * 100).toFixed(1)}% confidence)`, "bot");
        
        const verse = quranicVerses[emotion];
        addMessage(`üìñ Quranic Verse:\n${verse.verse}`, "bot");
        addMessage(`üîç Translation:\n${verse.translation}`, "bot");
      }, 1000);
    }

    function showSentimentTrend() {
      const modal = document.getElementById("chart-modal");
      const canvas = document.getElementById("sentimentChart");
      
      modal.style.display = "flex";
      
      if (window.sentimentChartInstance) {
        window.sentimentChartInstance.destroy();
      }
      
      const allEmotions = ['joy', 'sadness', 'anger', 'fear', 'love', 'surprise', 'neutral'];
      const data = allEmotions.map(emotion => emotionTrend[emotion] || 0);
      
      window.sentimentChartInstance = new Chart(canvas, {
        type: 'bar',
        data: {
          labels: allEmotions.map(capitalize),
          datasets: [{
            label: 'Emotion Frequency',
            data: data,
            backgroundColor: ['#00c6ff', '#ff4d4d', '#a29bfe', '#81ecec', '#fab1a0', '#55efc4', '#ffeaa7'],
            borderColor: '#0a0f0d',
            borderWidth: 2,
            borderRadius: 6
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true, ticks: { stepSize: 1 } }
          }
        }
      });
    }

    function closeModal() {
      document.getElementById("chart-modal").style.display = "none";
    }

    function addMessage(text, sender) {
      const chatBox = document.getElementById("chat-box");
      const messageDiv = document.createElement("div");
      messageDiv.classList.add("chat-message", sender);
      messageDiv.textContent = text;
      chatBox.appendChild(messageDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
      return messageDiv;
    }

    function updateStatsPanel() {
      document.getElementById("sessions-count").textContent = sessionCount;
      document.getElementById("current-emotion").textContent = currentEmotion;
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }
  </script>
</body>
</html>